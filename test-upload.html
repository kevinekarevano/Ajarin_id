<!DOCTYPE html>
<html>

<head>
    <title>Test File Upload</title>
</head>

<body>
    <h1>Test Course Creation with File Upload</h1>
    <form id="courseForm" enctype="multipart/form-data">
        <div>
            <label>Title:</label>
            <input type="text" name="title" value="Test Course Upload" required>
        </div>
        <div>
            <label>Description:</label>
            <textarea name="description" required>Test description for file upload</textarea>
        </div>
        <div>
            <label>Category:</label>
            <select name="category" required>
                <option value="Programming">Programming</option>
                <option value="Other">Other</option>
            </select>
        </div>
        <div>
            <label>Cover Image:</label>
            <input type="file" name="cover" accept="image/*" required>
        </div>
        <button type="submit">Create Course</button>
    </form>

    <script>
        document.getElementById('courseForm').addEventListener('submit', async (e) => {
            e.preventDefault();

            const formData = new FormData(e.target);

            // Add auth token (you'll need to replace this with a real token)
            const token = 'YOUR_AUTH_TOKEN_HERE';

            console.log('Sending FormData:');
            for (let [key, value] of formData.entries()) {
                if (value instanceof File) {
                    console.log(`${key}:`, {
                        name: value.name,
                        size: value.size,
                        type: value.type
                    });
                } else {
                    console.log(`${key}:`, value);
                }
            }

            try {
                const response = await fetch('http://localhost:3000/api/courses', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${token}`
                    },
                    body: formData
                });

                const result = await response.json();
                console.log('Response:', result);

                if (result.success) {
                    alert('Course created successfully!');
                } else {
                    alert('Error: ' + result.message);
                }
            } catch (error) {
                console.error('Error:', error);
                alert('Network error: ' + error.message);
            }
        });
    </script>
</body>

</html>
</script>